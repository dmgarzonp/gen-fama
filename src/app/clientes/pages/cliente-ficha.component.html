<div class="space-y-6" *ngIf="cliente">
  <div class="flex items-center justify-between">
    <div class="flex items-center gap-2">
      <lucide-icon name="user" class="w-5 h-5 text-emerald-600"></lucide-icon>
      <h2 class="text-xl font-semibold tracking-tight text-gray-900">Ficha de Cliente</h2>
    </div>
    <div class="flex gap-2">
      <a [routerLink]="['/clientes', cliente.id, 'editar']"
        class="flex items-center gap-2 bg-emerald-600 text-white hover:bg-emerald-700 transition-colors rounded-lg px-4 py-2 text-sm font-medium">
        <lucide-icon name="edit" class="w-4 h-4"></lucide-icon>
        Editar
      </a>
      <a routerLink="/clientes"
        class="flex items-center gap-2 border border-gray-300 text-gray-700 hover:bg-gray-50 transition-colors rounded-lg px-4 py-2 text-sm font-medium">
        <lucide-icon name="arrow-left" class="w-4 h-4"></lucide-icon>
        Volver
      </a>
    </div>
  </div>

  <div class="bg-white p-6 rounded-xl border border-gray-200 shadow-sm">
    <!-- Datos personales -->
    <div class="grid md:grid-cols-2 gap-6 mb-6">
      <div>
        <div class="mb-3 text-gray-700 font-semibold text-lg">Datos Personales</div>
        <ul class="space-y-2 text-sm text-gray-800">
          <li><span class="font-semibold">Nombre:</span> {{ cliente.nombre_completo }}</li>
          <li><span class="font-semibold">Identificación:</span> {{ cliente.identificacion }}</li>
          <li><span class="font-semibold">Teléfono:</span> {{ cliente.telefono }}</li>
          <li><span class="font-semibold">Email:</span> {{ cliente.email }}</li>
          <li><span class="font-semibold">Dirección:</span> {{ cliente.direccion }}</li>
          <li><span class="font-semibold">Fecha Nacimiento:</span> {{ cliente.fecha_nacimiento }}</li>
          <li>
            <span class="font-semibold">Alergias:</span>
            <span class="text-red-700 font-medium">{{ cliente.alergias || 'Ninguna registrada' }}</span>
          </li>
          <li>
            <span class="font-semibold">Enfermedades Crónicas:</span>
            <span class="text-orange-700 font-medium">{{ cliente.enfermedades_cronicas || 'Ninguna registrada' }}</span>
          </li>
        </ul>
      </div>
      <div>
        <div class="mb-3 text-gray-700 font-semibold text-lg">Información Comercial</div>
        <ul class="space-y-2 text-sm text-gray-800">
          <li>
            <span class="font-semibold">Tipo de cliente:</span>
            <span [class]="'px-2 py-1 rounded text-xs font-medium border ml-2 ' + getTipoClass(cliente.tipo || '')">
              {{ cliente.tipo }}
            </span>
          </li>
          <li><span class="font-semibold">Límite de crédito:</span> ${{ (cliente.limite_credito || 0).toLocaleString() }}</li>
          <li>
            <span class="font-semibold">Saldo pendiente:</span>
            <span [class]="(cliente.saldo_pendiente || 0) > 0 ? 'text-red-700 font-medium' : 'text-green-700'">
              ${{ (cliente.saldo_pendiente || 0).toLocaleString() }}
            </span>
          </li>
          <li><span class="font-semibold">Puntos/Fidelización:</span> <span class="text-blue-600 font-medium">{{
              cliente.puntos }}</span></li>
          <li><span class="font-semibold">Fecha de registro:</span> {{ cliente.fecha_registro }}</li>
          <li>
            <span class="font-semibold">Estado:</span>
            <span [class]="cliente.estado === 'activo' ? 'text-emerald-700 font-medium' : 'text-red-700 font-medium'">
              {{ cliente.estado === 'activo' ? 'Activo' : 'Inactivo' }}
            </span>
          </li>
        </ul>
      </div>
    </div>

    <!-- Historial -->
    <div class="border-t pt-6">
      <div class="mb-4 text-gray-700 font-semibold text-lg">Historial</div>
      <div class="grid md:grid-cols-3 gap-4">
        <div class="bg-gray-50 rounded-lg p-4">
          <div class="mb-2 text-gray-700 font-medium">Compras Realizadas</div>
          <div class="text-2xl font-bold text-emerald-600">{{ cliente.compras }}</div>
          <div class="text-xs text-gray-500 mt-1">Total de compras</div>
        </div>
        <div class="bg-gray-50 rounded-lg p-4">
          <div class="mb-2 text-gray-700 font-medium">Recetas Asociadas</div>
          <div class="text-2xl font-bold text-blue-600">{{ cliente.recetas }}</div>
          <div class="text-xs text-gray-500 mt-1">Recetas registradas</div>
        </div>
        <div class="bg-gray-50 rounded-lg p-4">
          <div class="mb-2 text-gray-700 font-medium">Productos Frecuentes</div>
          <ul class="space-y-1 text-sm text-gray-700">
            <li *ngFor="let prod of getProductosFrecuentes(cliente)" class="flex items-center gap-1">
              <lucide-icon name="pill" class="w-3 h-3 text-gray-400"></lucide-icon>
              {{ prod }}
            </li>
            <li *ngIf="getProductosFrecuentes(cliente).length === 0" class="text-gray-400 text-xs">Sin productos frecuentes
            </li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>

<div *ngIf="!cliente" class="text-center py-12">
  <p class="text-gray-500">Cliente no encontrado</p>
  <a routerLink="/clientes" class="text-emerald-600 hover:text-emerald-700 mt-4 inline-block">Volver al listado</a>
</div>